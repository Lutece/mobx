<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Common Pitfalls &amp; Best Practices | MobX</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.4.3">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-edit-link/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
    

        
    
    
    <link rel="next" href="../best/store.html" />
    
    
    <link rel="prev" href="../faq/faq.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="7.1" data-basepath=".." data-revision="Thu Dec 28 2017 00:35:52 GMT+0900 (KST)">
    

<div class="book-summary">
    <div class="book-search" role="search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Introduction to MobX</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="intro/overview.html">
            
                
                    <a href="../intro/overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        The Gist of MobX
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="intro/concepts.html">
            
                
                    <a href="../intro/concepts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Concepts &amp; Principles
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="refguide/api.html">
            
                
                    <a href="../refguide/api.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        API overview
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="refguide/observable.html">
            
                
                    <a href="../refguide/observable.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        observable
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="refguide/observable-decorator.html">
            
                
                    <a href="../refguide/observable-decorator.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        @observable
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="refguide/computed-decorator.html">
            
                
                    <a href="../refguide/computed-decorator.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        (@)computed
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="refguide/autorun.html">
            
                
                    <a href="../refguide/autorun.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        autorun
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="refguide/observer-component.html">
            
                
                    <a href="../refguide/observer-component.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        (@)observer
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="refguide/action.html">
            
                
                    <a href="../refguide/action.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        action
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> Observable Types</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="refguide/object.html">
            
                
                    <a href="../refguide/object.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        objects
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="refguide/array.html">
            
                
                    <a href="../refguide/array.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        arrays
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="refguide/map.html">
            
                
                    <a href="../refguide/map.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        maps
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="refguide/boxed.html">
            
                
                    <a href="../refguide/boxed.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        boxed values
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="best/react.html">
            
                
                    <a href="../best/react.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Understanding what MobX reacts to
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="best/decorators.html">
            
                
                    <a href="../best/decorators.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        How to (not) use decorators
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" >
            
            <span><b>6.</b> Resources</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="faq/blogs.html">
            
                
                    <a href="../faq/blogs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Tutorials, videos and blogs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="faq/related.html">
            
                
                    <a href="../faq/related.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Related Projects
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="faq/examples.html">
            
                
                    <a href="../faq/examples.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        Examples projects
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="faq/boilerplates.html">
            
                
                    <a href="../faq/boilerplates.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.4.</b>
                        
                        Boilerplates
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="faq/faq.html">
            
                
                    <a href="../faq/faq.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.5.</b>
                        
                        Frequently Asked Questions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" >
            
            <span><b>7.</b> Tips &amp; Tricks</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="7.1" data-path="best/pitfalls.html">
            
                
                    <a href="../best/pitfalls.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Common Pitfalls &amp; Best Practices
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="best/store.html">
            
                
                    <a href="../best/store.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        Defining data stores
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="best/actions.html">
            
                
                    <a href="../best/actions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                        Writing async actions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="best/react-performance.html">
            
                
                    <a href="../best/react-performance.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.</b>
                        
                        Optimizing React components
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="best/devtools.html">
            
                
                    <a href="../best/devtools.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.</b>
                        
                        DevTools
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.6" data-path="best/syntax.html">
            
                
                    <a href="../best/syntax.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.6.</b>
                        
                        ES5 / ES6 / TypeScript syntax
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.7" data-path="best/stateless-HMR.html">
            
                
                    <a href="../best/stateless-HMR.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.7.</b>
                        
                        Stateless Components and Hot Module Reloading
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" >
            
            <span><b>8.</b> Utility functions</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="refguide/autorun-async.html">
            
                
                    <a href="../refguide/autorun-async.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        autorunAsync
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="refguide/extending.html">
            
                
                    <a href="../refguide/extending.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Atom &amp; Reaction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="refguide/create-transformer.html">
            
                
                    <a href="../refguide/create-transformer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        createTransformer
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="refguide/expr.html">
            
                
                    <a href="../refguide/expr.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        expr
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="refguide/extend-observable.html">
            
                
                    <a href="../refguide/extend-observable.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        extendObservable
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.6" data-path="refguide/is-observable.html">
            
                
                    <a href="../refguide/is-observable.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                        isObservable
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.7" data-path="refguide/modifiers.html">
            
                
                    <a href="../refguide/modifiers.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.7.</b>
                        
                        modifiers
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.8" data-path="refguide/observe.html">
            
                
                    <a href="../refguide/observe.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.8.</b>
                        
                        intercept &amp; observe
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.9" data-path="refguide/reaction.html">
            
                
                    <a href="../refguide/reaction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.9.</b>
                        
                        reaction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.10" data-path="refguide/spy.html">
            
                
                    <a href="../refguide/spy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.10.</b>
                        
                        spy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.11" data-path="refguide/tojson.html">
            
                
                    <a href="../refguide/tojson.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.11.</b>
                        
                        toJS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.12" data-path="refguide/transaction.html">
            
                
                    <a href="../refguide/transaction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.12.</b>
                        
                        transaction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.13" data-path="refguide/untracked.html">
            
                
                    <a href="../refguide/untracked.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.13.</b>
                        
                        untracked
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.14" data-path="refguide/when.html">
            
                
                    <a href="../refguide/when.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.14.</b>
                        
                        when
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="donating.html">
            
                
                    <a href="../donating.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Donate
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >MobX</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <html><head></head><body><a id="edit-link" href="https://github.com/lutece/mobx/tree/gh-pages/docs/best/pitfalls.md" class="btn fa fa-edit pull-left">&#xA0;&#xA0;Edit This Page</a><h1 id="common-pitfalls-best-practices"><a name="common-pitfalls-best-practices" class="plugin-anchor" href="#common-pitfalls-best-practices"><span class="fa fa-link"></span></a>Common pitfalls &amp; best practices</h1>
<p>Stuck with MobX? This section contains a list of common issues people new to MobX might run into.</p>
<h4 id="importing-from-wrong-location"><a name="importing-from-wrong-location" class="plugin-anchor" href="#importing-from-wrong-location"><span class="fa fa-link"></span></a>Importing from wrong location</h4>
<p>Because MobX ships with typescript typings out of the box, some import autocompleting tools (at least in VSCode) have the habit of auto completing with a wrong import, like</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// wrong</span>
<span class="hljs-keyword">import</span> { observable } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx/lib/mobx&quot;</span>
</code></pre>
<p>This is incorrect but will not always immediately lead to runtime errors. So be aware. The only correct way of importing anything from the <code>mobx</code> package is:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// correct</span>
<span class="hljs-keyword">import</span> { observable } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobx&quot;</span>
</code></pre>
<h4 id="issues-with-decorators"><a name="issues-with-decorators" class="plugin-anchor" href="#issues-with-decorators"><span class="fa fa-link"></span></a>Issues with decorators?</h4>
<p>For setup tips and limitations on decorators, check the <a href="decorators.html">decorators</a> page</p>
<h4 id="-array-isarray-observable-1-2-3-false"><a name="-array-isarray-observable-1-2-3-false" class="plugin-anchor" href="#-array-isarray-observable-1-2-3-false"><span class="fa fa-link"></span></a><code>Array.isArray(observable([1,2,3])) === false</code></h4>
<p>In ES5 there is no way to reliably inherit from arrays, and hence observable arrays inherit from objects.
This means that regularly libraries are not able to recognize observable arrays as normal arrays (like lodash, or built-in operations like <code>Array.concat</code>).
This can simply be fixed by passing calling <code>observable.toJS()</code> or <code>observable.slice()</code> before passing the array to another library.
As long as the external library has no intent to modify the array, this will further work completely as expected.
You can use <code>isObservableArray(observable)</code> to check whether something is an observable array.</p>
<h4 id="-object-somenewprop-value-is-not-picked-up"><a name="-object-somenewprop-value-is-not-picked-up" class="plugin-anchor" href="#-object-somenewprop-value-is-not-picked-up"><span class="fa fa-link"></span></a><code>object.someNewProp = value</code> is not picked up</h4>
<p>MobX observable <em>objects</em> do not detect or react to property assignments that weren&apos;t declared observable before.
So MobX observable objects act as records with predefined keys.
You can use <code>extendObservable(target, props)</code> to introduce new observable properties to an object.
However object iterators like <code>for .. in</code> or <code>Object.keys()</code> won&apos;t react to this automatically.
If you need a dynamically keyed object, for example to store users by id, create observable _map_s using <a href="../refguide/map.html"><code>observable.map</code></a>.
For more info see <a href="react.html">what will MobX react to?</a>.</p>
<h3 id="use-observer-on-all-components-that-render-observable-s"><a name="use-observer-on-all-components-that-render-observable-s" class="plugin-anchor" href="#use-observer-on-all-components-that-render-observable-s"><span class="fa fa-link"></span></a>Use <code>@observer</code> on all components that render <code>@observable</code>s.</h3>
<p><code>@observer</code> only enhances the component you are decorating, not the components used inside it.
So usually all your components should be decorated. Don&apos;t worry, this is not inefficient, in contrast, more <code>observer</code> components make rendering more efficient.</p>
<h3 id="don-t-copy-observables-properties-and-store-them-locally"><a name="don-t-copy-observables-properties-and-store-them-locally" class="plugin-anchor" href="#don-t-copy-observables-properties-and-store-them-locally"><span class="fa fa-link"></span></a>Don&apos;t copy observables properties and store them locally</h3>
<p>Observer components only track data that is accessed <em>during</em> the render method. A common mistake is that data plucked of from an observable property and stored will for that reason not be tracked:</p>
<pre><code>class User {
  @observable name
}

class Profile extends React.Component {
  name

  componentWillMount() {
    // Wrong
    // This dereferences user.name and just copies the value once! Future updates will not be tracked, as lifecycle hooks are not reactive
    // assignments like these create redundant data
    this.name = this.props.user.name
  }

  render() {
    return &lt;div&gt;{this.name}&lt;/div&gt;
  }
}
</code></pre><p>The correct approach is either by not storing the values of observables locally (obviously, the above example is simple but contrived), or by defining them as computed property:</p>
<pre><code>class User {
  @observable name
}

class Profile extends React.Component {
  @computed get name() {
    // correct; computed property will track the `user.name` property
    return this.props.user.name
  }

  render() {
    return &lt;div&gt;{this.name}&lt;/div&gt;
  }
}
</code></pre><h3 id="render-callbacks-are-not-part-of-the-render-method"><a name="render-callbacks-are-not-part-of-the-render-method" class="plugin-anchor" href="#render-callbacks-are-not-part-of-the-render-method"><span class="fa fa-link"></span></a>Render callbacks are <em>not</em> part of the render method</h3>
<p>Because <code>observer</code> only applies to exactly the <code>render</code> function of the current component; passing a render callback or component to a child component doesn&apos;t become reactive automatically.
For more details, see the <a href="https://github.com/mobxjs/mobx/blob/gh-pages/docs/best/react.md#mobx-only-tracks-data-accessed-for-observer-components-if-they-are-directly-accessed-by-render" target="_blank">what will Mobx react to</a> guide.</p>
<h3 id="dereference-values-as-late-as-possible"><a name="dereference-values-as-late-as-possible" class="plugin-anchor" href="#dereference-values-as-late-as-possible"><span class="fa fa-link"></span></a>Dereference values as late as possible</h3>
<p>MobX can do a lot, but it cannot make primitive values observable (although it can wrap them in an object see <a href="../refguide/boxed.html">boxed observables</a>).
So it is not the <em>values</em> that are observable, but the <em>properties</em> of an object. This means that <code>@observer</code> actually reacts to the fact that you dereference a value.
So in our above example, the <code>Timer</code> component would <strong>not</strong> react if it was initialized as follows:</p>
<pre><code class="lang-javascript">React.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">Timer</span> <span class="hljs-attribute">timerData</span>=<span class="hljs-value">{timerData.secondsPassed}</span> /&gt;</span>, document.body)
</span></code></pre>
<p>In this snippet just the current value of <code>secondsPassed</code> is passed to the <code>Timer</code>, which is the immutable value <code>0</code> (all primitives are immutable in JS).
That number won&apos;t change anymore in the future, so <code>Timer</code> will never update. It is the property <code>secondsPassed</code> that will change in the future,
so we need to access it <em>in</em> the component. Or in other words: always try to pass the owning object of an observable property.
For more info see <a href="react.html">what will MobX react to?</a>.</p>
<h4 id="computed-values-run-more-often-than-expected"><a name="computed-values-run-more-often-than-expected" class="plugin-anchor" href="#computed-values-run-more-often-than-expected"><span class="fa fa-link"></span></a>Computed values run more often than expected</h4>
<p>If a computed property is <em>not</em> in use by some reaction (<code>autorun</code>, <code>observer</code> etc), computed expressions will be evaluated lazily; each time their value is requested (so they just act as normal property).
Computed values will only track their dependencies if they are observed.
This allows MobX to automatically suspend computations that are not actively in use.
See this <a href="https://medium.com/@mweststrate/becoming-fully-reactive-an-in-depth-explanation-of-mobservable-55995262a254" target="_blank">blog</a> or <a href="https://github.com/mobxjs/mobx/issues/356" target="_blank">issue #356</a> for an explanation.
So if you fiddle arounds, computed properties might not seem efficient. But when applied in a project that uses <code>observer</code>, <code>autorun</code> etc, they become very efficient.</p>
<p>MobX computeds will automatically be kept alive during transactions as well, see PRs: <a href="https://github.com/mobxjs/mobx/pull/452" target="_blank">#452</a> and <a href="https://github.com/mobxjs/mobx/pull/489" target="_blank">#489</a></p>
<h4 id="always-dispose-reactions"><a name="always-dispose-reactions" class="plugin-anchor" href="#always-dispose-reactions"><span class="fa fa-link"></span></a>Always dispose reactions</h4>
<p>All forms of <code>autorun</code>, <code>observe</code> and <code>intercept</code> will only be garbage collected if all objects they observe are garbage collected themselves.
So it is recommend to use the disposer function that is returned from these methods to stop them when you no longer need them.
Usually for <code>observe</code> and <code>intercept</code> it is not strictly necessary to dispose them if when targed <code>this</code>.
For reactions like <code>autorun</code> it is more tricky, as they might observe many different observables, and as long as one of them is still in scope,
the reaction will remain in scope which means that all other observables it uses are also kept alive to support future recomputions.
So make sure to always dispose your reactions when you no longer need them!</p>
<p>Example:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> VAT = observable(<span class="hljs-number">1.20</span>)

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderLIne</span> </span>{
    @observable price = <span class="hljs-number">10</span>;
    @observable amount = <span class="hljs-number">1</span>;
    constructor() {
        <span class="hljs-comment">// this autorun will be GC-ed together with the current orderline instance</span>
        <span class="hljs-keyword">this</span>.handler = autorun(() =&gt; {
            doSomethingWith(<span class="hljs-keyword">this</span>.price * <span class="hljs-keyword">this</span>.amount)
        })
        <span class="hljs-comment">// this autorun won&apos;t be GC-ed together with the current orderline instance</span>
        <span class="hljs-comment">// since VAT keeps a reference to notify this autorun,</span>
        <span class="hljs-comment">// which in turn keeps &apos;this&apos; in scope</span>
        <span class="hljs-keyword">this</span>.handler = autorun(() =&gt; {
            doSomethingWith(<span class="hljs-keyword">this</span>.price * <span class="hljs-keyword">this</span>.amount * VAT.get())
        })
        <span class="hljs-comment">// So, to avoid subtle memory issues, always call..</span>
        <span class="hljs-keyword">this</span>.handler()
        <span class="hljs-comment">// When the reaction is no longer needed!</span>
    }
}
</code></pre>
<h4 id="i-have-a-weird-exception-when-using-observable-in-a-react-component"><a name="i-have-a-weird-exception-when-using-observable-in-a-react-component" class="plugin-anchor" href="#i-have-a-weird-exception-when-using-observable-in-a-react-component"><span class="fa fa-link"></span></a>I have a weird exception when using <code>@observable</code> in a React component.</h4>
<p>The following exception: <code>Uncaught TypeError: Cannot assign to read only property &apos;__mobxLazyInitializers&apos; of object</code> occurs when using a <code>react-hot-loader</code> that does not support decorators.
Either use <code>extendObservable</code> in <code>componentWillMount</code> instead of <code>@observable</code>, or upgrade to <code>react-hot-loader</code> <code>&quot;^3.0.0-beta.2&quot;</code> or higher.</p>
<h4 id="the-display-name-of-react-components-is-not-set"><a name="the-display-name-of-react-components-is-not-set" class="plugin-anchor" href="#the-display-name-of-react-components-is-not-set"><span class="fa fa-link"></span></a>The display name of react components is not set</h4>
<p>If you use <code>export const MyComponent = observer((props =&gt; &lt;div&gt;hi&lt;/div&gt;))</code>, no display name will be visible in the devtools.
The following approaches can be used to fix this:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// 1 (set displayName explicitly)</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> MyComponent = observer((props =&gt; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>hi<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>)</span>)
myComponent.displayName = <span class="hljs-string">&quot;MyComponent&quot;</span>

<span class="hljs-comment">// 2 (MobX infers component name from function name)</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> MyComponent = observer(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MyComponent</span>(<span class="hljs-params">props</span>) </span>{ <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>hi<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span> })

// 3 (transpiler will infer component name from variable name)
const _MyComponent = observer((props =&gt; <span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>hi<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>)</span>) <span class="hljs-comment">//</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> MyComponent = observer(_MyComponent)

<span class="hljs-comment">// 4 (with default export)</span>
<span class="hljs-keyword">const</span> MyComponent = observer((props =&gt; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>hi<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>)</span>)
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> observer(MyComponent)
</code></pre>
<p>See also: <a href="http://mobxjs.github.io/mobx/best/stateless-HMR.html" target="_blank">http://mobxjs.github.io/mobx/best/stateless-HMR.html</a> or <a href="https://github.com/mobxjs/mobx/issues/141#issuecomment-228457886" target="_blank">#141</a>.</p>
<h4 id="the-proptype-of-an-observable-array-is-object"><a name="the-proptype-of-an-observable-array-is-object" class="plugin-anchor" href="#the-proptype-of-an-observable-array-is-object"><span class="fa fa-link"></span></a>The propType of an observable array is object</h4>
<p>Observable arrays are actually objects, so they comply to <code>propTypes.object</code> instead of <code>array</code>.
<code>mobx-react</code> provides its explicit <code>PropTypes</code> for observable data structures.</p>
<h4 id="rendering-listviews-in-react-native"><a name="rendering-listviews-in-react-native" class="plugin-anchor" href="#rendering-listviews-in-react-native"><span class="fa fa-link"></span></a>Rendering ListViews in React Native</h4>
<p><code>ListView.DataSource</code> in React Native expects real arrays. Observable arrays are actually objects, make sure to <code>.slice()</code> them first before passing to list views. Furthermore, <code>ListView.DataSource</code> itself can be moved to the store and have it automatically updated with a <code>@computed</code>, this step can also be done on the component level.</p>
<pre><code class="lang-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListStore</span> </span>{
  @observable list = [
    <span class="hljs-string">&apos;Hello World!&apos;</span>,
    <span class="hljs-string">&apos;Hello React Native!&apos;</span>,
    <span class="hljs-string">&apos;Hello MobX!&apos;</span>
  ];

  ds = <span class="hljs-keyword">new</span> ListView.DataSource({ rowHasChanged: (r1, r2) =&gt; r1 !== r2 });

  @computed get dataSource() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.ds.cloneWithRows(<span class="hljs-keyword">this</span>.list.slice());
  }
}

<span class="hljs-keyword">const</span> listStore = <span class="hljs-keyword">new</span> ListStore();

@observer <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">List</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">ListView</span>
        <span class="hljs-attribute">dataSource</span>=<span class="hljs-value">{listStore.dataSource}</span>
        <span class="hljs-attribute">renderRow</span>=<span class="hljs-value">{row</span> =&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-title">Text</span>&gt;</span>{row}<span class="hljs-tag">&lt;/<span class="hljs-title">Text</span>&gt;</span>}
        enableEmptySections={true}
      /&gt;
    )</span>;
  }
}
</code></pre>
<p>For more info see <a href="https://github.com/mobxjs/mobx/issues/476" target="_blank">#476</a></p>
<h4 id="declaring-proptypes-might-cause-unnecessary-renders-in-dev-mode"><a name="declaring-proptypes-might-cause-unnecessary-renders-in-dev-mode" class="plugin-anchor" href="#declaring-proptypes-might-cause-unnecessary-renders-in-dev-mode"><span class="fa fa-link"></span></a>Declaring propTypes might cause unnecessary renders in dev mode</h4>
<p>See: <a href="https://github.com/mobxjs/mobx-react/issues/56" target="_blank">https://github.com/mobxjs/mobx-react/issues/56</a></p>
<h4 id="-observable-properties-initialize-lazily-when-using-babel"><a name="-observable-properties-initialize-lazily-when-using-babel" class="plugin-anchor" href="#-observable-properties-initialize-lazily-when-using-babel"><span class="fa fa-link"></span></a><code>@observable</code> properties initialize lazily when using Babel</h4>
<p>This issue only occurs when transpiling with Babel and not with Typescript (in which decorator support is more mature).
Observable properties will not be instantiated upon an instance until the first read / write to a property (at that point they all will be initialized).
This results in the following subtle bug:</p>
<pre><code class="lang-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Todo</span> </span>{
    @observable done = <span class="hljs-literal">true</span>
    @observable title = <span class="hljs-string">&quot;test&quot;</span>
}
<span class="hljs-keyword">const</span> todo = <span class="hljs-keyword">new</span> Todo()

<span class="hljs-string">&quot;done&quot;</span> <span class="hljs-keyword">in</span> todo <span class="hljs-comment">// true</span>
todo.hasOwnProperty(<span class="hljs-string">&quot;done&quot;</span>) <span class="hljs-comment">// false</span>
<span class="hljs-built_in">Object</span>.keys(todo) <span class="hljs-comment">// []</span>

<span class="hljs-built_in">console</span>.log(todo.title)
<span class="hljs-string">&quot;done&quot;</span> <span class="hljs-keyword">in</span> todo <span class="hljs-comment">// true</span>
todo.hasOwnProperty(<span class="hljs-string">&quot;done&quot;</span>) <span class="hljs-comment">// true</span>
<span class="hljs-built_in">Object</span>.keys(todo) <span class="hljs-comment">// [&quot;done&quot;, &quot;title&quot;]</span>
</code></pre>
<p>In practice this is rarely an issue, only when using generic methods like <code>Object.assign(target, todo)</code> or <code>assert.deepEquals</code> <em>before</em> reading or writing any property of the object.
If you want to make sure that this issue doesn&apos;t occur, just initialize the fields in the constructor instead of at the field declaration or use <code>extendObservable</code> to create the observable properties.</p>
</body></html>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../faq/faq.html" class="navigation navigation-prev " aria-label="Previous page: Frequently Asked Questions"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../best/store.html" class="navigation navigation-next " aria-label="Next page: Defining data stores"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-github/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-disqus/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-edit-link/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"github":{"url":"https://github.com/lutece/mobx"},"edit-link":{"base":"https://github.com/lutece/mobx/tree/gh-pages/docs","label":"Edit This Page"},"ga":{"token":"UA-65632006-1","configuration":"auto"},"disqus":{"shortName":"mobservable"}};
    gitbook.start(config);
});
</script>

        <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-65632006-1', 'auto');ga('send', 'pageview');</script>
    </body>
    
</html>
